<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Vehicle Finder – Multi‑Step Form</title>
  <style>
    * { box-sizing: border-box; font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif; }
    :root{
      --bg:#0b1220;
      --card:#0f172a;
      --text:#e5e7eb;
      --muted:#94a3b8;
      --border:#1e293b;
      --shadow:0 20px 40px rgba(0,0,0,.55);
      --radius:18px;
      --accent:#dc2626;
      --accentDark:#991b1b;
      --success:#16a34a;
      --dangerBg:#3f1d1d;
      --dangerText:#fecaca;
    }
    body { margin:0; background:radial-gradient(1200px 600px at 20% -10%, #1e293b 0%, #020617 60%); display:flex; justify-content:center; padding:24px; color:var(--text); }

    .card { background:linear-gradient(180deg,#0f172a,#020617); width:100%; max-width:760px; border-radius:22px; padding:22px; box-shadow:var(--shadow); border:1px solid var(--border); }
    h1 { margin:0 0 12px; font-size:20px; }

    .stepper { margin-bottom:18px; }
    .stepperRow { display:flex; align-items:center; justify-content:space-between; color:#6b7280; font-size:12px; margin-bottom:8px; }
    .progress { height:8px; background:#020617; border-radius:999px; overflow:hidden; border:1px solid var(--border); }
    .progress > div { height:100%; width:0%; background:linear-gradient(90deg,var(--success),#22c55e); transition:width .25s; }
    .dots { display:grid; grid-template-columns:repeat(11, 1fr); gap:6px; margin-top:10px; }
    .dot { height:6px; border-radius:999px; background:#e5e7eb; }
    .dot.done { background:#86efac; }
    .dot.active { background:#22c55e; }

    h2 { margin:0 0 10px; font-size:20px; }
    .helper { margin:0 0 14px; color:#6b7280; font-size:13px; line-height:1.35; }

    .grid { display:grid; gap:12px; }
    .grid-2 { grid-template-columns:1fr; }
    @media (min-width: 720px) { .grid-2 { grid-template-columns:repeat(2, 1fr); } }

    input, textarea, select { width:100%; padding:12px; border-radius:14px; border:1px solid var(--border); background:#020617; color:var(--text); font-size:14px; outline:none; }
    input:focus, textarea:focus, select:focus { box-shadow:0 0 0 3px rgba(34,197,94,.18); border-color:#86efac; }
    textarea { min-height:120px; resize:vertical; }
    select:disabled { color:#9ca3af; background:#f3f4f6; }

    .error { display:none; background:var(--dangerBg); color:var(--dangerText); padding:12px; border-radius:14px; margin:12px 0 14px; border:1px solid #7f1d1d; }

    .sectionRow { display:flex; align-items:center; justify-content:space-between; gap:10px; margin:10px 0 10px; }
    .sectionRow .title { font-size:22px; font-weight:800; }
    .clearLink { color:#2563eb; font-size:18px; cursor:pointer; user-select:none; }
    .clearLink:hover { text-decoration:underline; }

    .tileGrid { display:grid; grid-template-columns:repeat(2, 1fr); gap:12px; }
    .tile { border:1px solid var(--border); border-radius:14px; padding:14px 12px; cursor:pointer; display:flex; flex-direction:column; align-items:center; justify-content:center; gap:10px; text-align:center; background:#020617; min-height:92px; user-select:none; transition:transform .12s ease, box-shadow .12s ease, border-color .12s ease, background .12s ease; }
    .tile:hover { transform:translateY(-1px); box-shadow:0 10px 20px rgba(0,0,0,.06); }
    .tile.active { border-color:var(--accent); background:linear-gradient(180deg,#1f2933,#020617); box-shadow:0 0 0 1px rgba(220,38,38,.35), 0 10px 30px rgba(0,0,0,.6); }
    .tile svg { width:56px; height:30px; stroke:#111827; fill:none; stroke-width:2; }
    .tile .label { font-size:16px; }

    .swatch { width:22px; height:22px; border-radius:999px; border:1px solid rgba(0,0,0,.14); }

    .rangeBox { margin-bottom:18px; }
    .rangeHeader { display:flex; justify-content:space-between; margin-bottom:8px; font-weight:700; }
    .rangeHeader .val { font-size:22px; }

    .sliderWrap { position:relative; height:44px; margin:6px 0 12px; }
    .sliderTrack { position:absolute; left:0; right:0; top:50%; transform:translateY(-50%); height:6px; background:#e5e7eb; border-radius:999px; }
    .sliderFill { position:absolute; top:50%; transform:translateY(-50%); height:6px; background:#dc2626; border-radius:999px; left:0; right:0; }

    input[type=range] { position:absolute; width:100%; top:0; height:44px; pointer-events:none; -webkit-appearance:none; background:none; margin:0; }
    input[type=range]::-webkit-slider-thumb {
      -webkit-appearance:none; height:26px; width:26px; background:#dc2626; border-radius:50%;
      pointer-events:auto; border:3px solid #111827; box-shadow:0 6px 12px rgba(0,0,0,.18); cursor:pointer; margin-top:-10px;
    }
    input[type=range]::-moz-range-thumb {
      height:26px; width:26px; background:#dc2626; border-radius:50%; pointer-events:auto;
      border:3px solid #111827; box-shadow:0 6px 12px rgba(0,0,0,.18); cursor:pointer;
    }
    input[type=range]::-webkit-slider-runnable-track { height:6px; background:transparent; }
    input[type=range]::-moz-range-track { height:6px; background:transparent; }

    .actions { display:flex; justify-content:space-between; margin-top:22px; gap:12px; }
    button { padding:12px 18px; border-radius:14px; border:none; cursor:pointer; font-weight:800; font-size:14px; }
    button.secondary { background:#020617; color:var(--text); border:1px solid var(--border); }
    button.primary { background:#020617; color:var(--muted); border:1px solid var(--border); }
    button.primary.ready { background:linear-gradient(180deg,#16a34a,#15803d); color:white; border:none; box-shadow:0 10px 25px rgba(22,163,74,.45); }
    button:disabled { opacity:.45; cursor:not-allowed; }

    .hidden { display:none; }

    .selectLabel { margin:0 0 6px; color:#6b7280; font-size:13px; font-weight:700; }

    .makeSelect { position:relative; }
    .makeButton {
      width:100%; display:flex; align-items:center; justify-content:space-between; gap:10px;
      padding:12px; border:1px solid #e5e7eb; border-radius:12px; background:#fff; cursor:pointer;
    }
    .makeButton:focus { outline:none; box-shadow:0 0 0 3px rgba(34,197,94,.18); border-color:#86efac; }
    .makeValue { display:flex; align-items:center; gap:10px; min-width:0; }
    .logo { width:22px; height:22px; border-radius:8px; background:#f3f4f6; border:1px solid #e5e7eb; display:flex; align-items:center; justify-content:center; font-size:10px; font-weight:900; color:#111827; flex:0 0 auto; }
    .logo svg { width:18px; height:18px; }
    .logo svg .ring { stroke:#111827; fill:none; stroke-width:2; }
    .logo svg text { fill:#111827; font-weight:900; font-size:8.5px; font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif; dominant-baseline:middle; text-anchor:middle; }
    .makeText { font-weight:800; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
    .chev { width:10px; height:10px; border-right:2px solid #111827; border-bottom:2px solid #111827; transform:rotate(45deg); margin-right:4px; }

    .makeMenu { position:absolute; left:0; right:0; top:calc(100% + 8px); z-index:50; background:#fff; border:1px solid #e5e7eb; border-radius:14px; box-shadow:0 16px 30px rgba(0,0,0,.10); overflow:hidden; display:none; }
    .makeMenu.open { display:block; }
    .makeSearch { padding:10px; border-bottom:1px solid #f1f5f9; }
    .makeSearch input { padding:10px; border-radius:10px; }
    .makeList { max-height:260px; overflow:auto; }
    .makeItem { display:flex; align-items:center; gap:10px; padding:10px 12px; cursor:pointer; }
    .makeItem:hover { background:#f8fafc; }
    .makeItem .name { font-weight:800; }

    .summary { background:#f9fafb; border-radius:16px; padding:16px; font-size:14px; line-height:1.6; border:1px solid #e5e7eb; }
    .summaryGrid { display:grid; gap:10px; }
    .summaryRow { display:grid; grid-template-columns:140px 1fr; gap:10px; padding:10px; background:#fff; border:1px solid #eef2f7; border-radius:12px; }
    .summaryKey { color:#6b7280; font-weight:900; font-size:12px; text-transform:uppercase; letter-spacing:.03em; }
    .summaryVal { font-weight:800; }
  </style>
</head>
<body>
  <div class="card">
    <h1>Vehicle Finder</h1>

    <div class="stepper">
      <div class="stepperRow">
        <div id="stepLabel">Step 1 of 11</div>
        <div id="pctLabel">9%</div>
      </div>
      <div class="progress"><div id="progressBar"></div></div>
      <div class="dots" id="dots" aria-hidden="true"></div>
    </div>

    <div id="error" class="error">Please, choose at least one</div>

    <!-- STEP 1 -->
    <div class="step" data-step="0">
      <h2>Tell me about yourself</h2>
      <p class="helper">Next becomes available once you enter your name and at least one contact method (phone or email).</p>
      <div class="grid grid-2">
        <div>
          <div class="selectLabel">First name</div>
          <input id="firstName" placeholder="First name" autocomplete="given-name" />
        </div>
        <div>
          <div class="selectLabel">Last name</div>
          <input id="lastName" placeholder="Last name" autocomplete="family-name" />
        </div>
      </div>
      <div class="grid grid-2" style="margin-top:12px">
        <div>
          <div class="selectLabel">Phone</div>
          <input id="phone" placeholder="Phone" autocomplete="tel" />
        </div>
        <div>
          <div class="selectLabel">Email</div>
          <input id="email" placeholder="Email" type="email" autocomplete="email" />
        </div>
      </div>
    </div>

    <!-- STEP 2 -->
    <div class="step hidden" data-step="1">
      <div class="sectionRow">
        <div class="title">What do you need the vehicle for?</div>
        <div class="clearLink" data-clear="use">Clear</div>
      </div>
      <div class="tileGrid" id="useGrid"></div>
    </div>

    <!-- STEP 3 -->
    <div class="step hidden" data-step="2">
      <div class="sectionRow">
        <div class="title">Bodystyles</div>
        <div class="clearLink" data-clear="body">Clear</div>
      </div>
      <div class="tileGrid" id="bodyGrid"></div>
    </div>

    <!-- STEP 4 -->
    <div class="step hidden" data-step="3">
      <h2>Makes &amp; Models</h2>
      <p class="helper">Dropdown uses make name + logo badge. Model list updates by selected make.</p>

      <div class="grid grid-2">
        <div>
          <div class="selectLabel">Make</div>
          <div class="makeSelect" id="makeSelect">
            <button class="makeButton" id="makeButton" type="button" aria-haspopup="listbox" aria-expanded="false">
              <div class="makeValue">
                <div class="logo" id="makeLogo">—</div>
                <div class="makeText" id="makeText">Choose a make</div>
              </div>
              <div class="chev" aria-hidden="true"></div>
            </button>
            <div class="makeMenu" id="makeMenu" role="listbox" aria-label="Makes">
              <div class="makeSearch">
                <input id="makeSearch" placeholder="Search makes..." />
              </div>
              <div class="makeList" id="makeList"></div>
            </div>
          </div>
        </div>

        <div>
          <div class="selectLabel">Model</div>
          <select id="model" disabled>
            <option value="">Select make first</option>
          </select>
        </div>
      </div>
    </div>

    <!-- STEP 5 -->
    <div class="step hidden" data-step="4">
      <h2>Price, years, mileage</h2>

      <div class="rangeBox">
        <div class="rangeHeader"><span>Price</span><span class="val" id="priceRangeLabel">$5,000 – $100,000</span></div>
        <div class="sliderWrap">
          <div class="sliderTrack"></div>
          <div class="sliderFill" id="priceFill"></div>
          <input type="range" id="priceMin" min="5000" max="100000" step="500" value="5000" />
          <input type="range" id="priceMax" min="5000" max="100000" step="500" value="100000" />
        </div>
      </div>

      <div class="rangeBox">
        <div class="rangeHeader"><span>Years</span><span class="val" id="yearRangeLabel">2010 – 2026</span></div>
        <div class="sliderWrap">
          <div class="sliderTrack"></div>
          <div class="sliderFill" id="yearFill"></div>
          <input type="range" id="yearMin" min="2010" max="2026" step="1" value="2010" />
          <input type="range" id="yearMax" min="2010" max="2026" step="1" value="2026" />
        </div>
      </div>

      <div class="rangeBox">
        <div class="rangeHeader"><span>Mileage (km)</span><span class="val" id="mileRangeLabel">0 – 300,000</span></div>
        <div class="sliderWrap">
          <div class="sliderTrack"></div>
          <div class="sliderFill" id="mileFill"></div>
          <input type="range" id="mileMin" min="0" max="300000" step="5000" value="0" />
          <input type="range" id="mileMax" min="0" max="300000" step="5000" value="300000" />
        </div>
      </div>
    </div>

    <!-- STEP 6 -->
    <div class="step hidden" data-step="5">
      <div class="sectionRow">
        <div class="title">Transmissions</div>
        <div class="clearLink" data-clear="trans">Clear</div>
      </div>
      <div class="tileGrid" id="transGrid"></div>

      <div class="sectionRow" style="margin-top:16px">
        <div class="title">Drivetrain</div>
        <div class="clearLink" data-clear="drive">Clear</div>
      </div>
      <div class="tileGrid" id="driveGrid"></div>
    </div>

    <!-- STEP 7 -->
    <div class="step hidden" data-step="6">
      <div class="sectionRow">
        <div class="title">Exterior color</div>
        <div class="clearLink" data-clear="colors">Clear</div>
      </div>
      <div class="tileGrid" id="colorGrid"></div>

      <div class="sectionRow" style="margin-top:16px">
        <div class="title">Interior</div>
        <div class="clearLink" data-clear="interior">Clear</div>
      </div>
      <div class="tileGrid" id="interiorGrid"></div>
    </div>

    <!-- STEP 8 -->
    <div class="step hidden" data-step="7">
      <div class="sectionRow">
        <div class="title">Additional options</div>
        <div class="clearLink" data-clear="addons">Clear</div>
      </div>
      <div class="tileGrid" id="addonGrid"></div>
    </div>

    <!-- STEP 9 -->
    <div class="step hidden" data-step="8">
      <h2>What else should the vehicle have?</h2>
      <p class="helper">Optional.</p>
      <textarea id="notes" placeholder="Example: must have Apple CarPlay, prefer no accidents..."></textarea>
    </div>

    <!-- STEP 10 (Summary) -->
    <div class="step hidden" data-step="9">
      <h2>Summary</h2>
      <p class="helper">Review your selections.</p>
      <div class="summary" id="summaryBox"></div>
    </div>

    <!-- STEP 11 (Thanks) -->
    <div class="step hidden" data-step="10">
      <h2>Thanks for your time</h2>
      <p class="helper">We will contact you as soon as we find something that will meet our criteria.</p>
      <div class="actions" style="justify-content:center">
        <button id="restartBtn" class="secondary" type="button">Start over</button>
      </div>
    </div>

    <div class="actions" id="navActions">
      <button id="prevBtn" class="secondary" type="button">Previous</button>
      <button id="nextBtn" class="primary" type="button">Next</button>
    </div>

  </div>

<script>
  const svg = {
    family: () => '<svg viewBox="0 0 64 32" xmlns="http://www.w3.org/2000/svg"><path d="M10 26c0-5 4-9 9-9s9 4 9 9"/><path d="M19 16a5 5 0 1 0 0-10 5 5 0 0 0 0 10Z"/><path d="M36 26c0-4 3-7 7-7s7 3 7 7"/><path d="M43 18a4 4 0 1 0 0-8 4 4 0 0 0 0 8Z"/></svg>',
    commute: () => '<svg viewBox="0 0 64 32" xmlns="http://www.w3.org/2000/svg"><path d="M12 23h40"/><path d="M18 23l4-10h20l4 10"/><path d="M20 23a4 4 0 1 0 0 8 4 4 0 0 0 0-8Z"/><path d="M44 23a4 4 0 1 0 0 8 4 4 0 0 0 0-8Z"/></svg>',
    fun: () => '<svg viewBox="0 0 64 32" xmlns="http://www.w3.org/2000/svg"><path d="M32 3l2 7 7 2-7 2-2 7-2-7-7-2 7-2 2-7Z"/><path d="M12 18l1.5 5L19 25l-5.5 2L12 32l-1.5-5L5 25l5.5-2L12 18Z"/></svg>',
    work: () => '<svg viewBox="0 0 64 32" xmlns="http://www.w3.org/2000/svg"><path d="M22 10V7a3 3 0 0 1 3-3h14a3 3 0 0 1 3 3v3"/><path d="M10 10h44a4 4 0 0 1 4 4v10a6 6 0 0 1-6 6H16a6 6 0 0 1-6-6V14a4 4 0 0 1 4-4Z"/><path d="M6 18h52"/></svg>',

    hatchback: () => '<svg viewBox="0 0 64 32" xmlns="http://www.w3.org/2000/svg"><path d="M10 22h44"/><path d="M16 22l4-9h18l8 9"/><path d="M20 22a4 4 0 1 0 0 8 4 4 0 0 0 0-8Z"/><path d="M44 22a4 4 0 1 0 0 8 4 4 0 0 0 0-8Z"/><path d="M26 13v-5h10v5"/></svg>',
    minivan: () => '<svg viewBox="0 0 64 32" xmlns="http://www.w3.org/2000/svg"><path d="M8 22h48"/><path d="M14 22l4-10h28l4 10"/><path d="M18 22a4 4 0 1 0 0 8 4 4 0 0 0 0-8Z"/><path d="M46 22a4 4 0 1 0 0 8 4 4 0 0 0 0-8Z"/><path d="M22 12h20"/></svg>',
    pickup: () => '<svg viewBox="0 0 64 32" xmlns="http://www.w3.org/2000/svg"><path d="M6 22h52"/><path d="M10 22l4-9h18l4 6h14v3"/><path d="M20 22a4 4 0 1 0 0 8 4 4 0 0 0 0-8Z"/><path d="M44 22a4 4 0 1 0 0 8 4 4 0 0 0 0-8Z"/></svg>',
    crewcab: () => '<svg viewBox="0 0 64 32" xmlns="http://www.w3.org/2000/svg"><path d="M6 22h52"/><path d="M10 22l4-9h26l4 6h10v3"/><path d="M20 22a4 4 0 1 0 0 8 4 4 0 0 0 0-8Z"/><path d="M44 22a4 4 0 1 0 0 8 4 4 0 0 0 0-8Z"/><path d="M24 13v-5h8v5"/><path d="M34 13v-5h8v5"/></svg>',
    suv: () => '<svg viewBox="0 0 64 32" xmlns="http://www.w3.org/2000/svg"><path d="M10 22h44"/><path d="M16 22l5-10h22l5 10"/><path d="M20 22a4 4 0 1 0 0 8 4 4 0 0 0 0-8Z"/><path d="M44 22a4 4 0 1 0 0 8 4 4 0 0 0 0-8Z"/><path d="M24 12h16"/></svg>',
    sedan: () => '<svg viewBox="0 0 64 32" xmlns="http://www.w3.org/2000/svg"><path d="M10 22h44"/><path d="M16 22l4-9h24l4 9"/><path d="M20 22a4 4 0 1 0 0 8 4 4 0 0 0 0-8Z"/><path d="M44 22a4 4 0 1 0 0 8 4 4 0 0 0 0-8Z"/><path d="M26 13v-5h12v5"/></svg>',

    gear: () => '<svg viewBox="0 0 64 32" xmlns="http://www.w3.org/2000/svg"><path d="M32 8a8 8 0 1 0 0 16 8 8 0 0 0 0-16Z"/><path d="M32 3v5M32 24v5M18 16h-5M51 16h-5"/><path d="M21 7l4 4M39 21l4 4M43 7l-4 4M25 21l-4 4"/></svg>',
    wheel: () => '<svg viewBox="0 0 64 32" xmlns="http://www.w3.org/2000/svg"><circle cx="32" cy="16" r="12"/><circle cx="32" cy="16" r="3"/><path d="M20 16h8M36 16h8"/><path d="M24 24c2-3 5-4 8-4s6 1 8 4"/></svg>',

    leather: () => '<svg viewBox="0 0 64 32" xmlns="http://www.w3.org/2000/svg"><path d="M18 26V16c0-5 3-8 8-8h12c5 0 8 3 8 8v10"/><path d="M18 20h28"/><path d="M22 26v-3M42 26v-3"/></svg>',
    cloth: () => '<svg viewBox="0 0 64 32" xmlns="http://www.w3.org/2000/svg"><rect x="18" y="8" width="28" height="18" rx="4"/><path d="M22 12h20M22 16h20M22 20h20"/></svg>',

    sunroof: () => '<svg viewBox="0 0 64 32" xmlns="http://www.w3.org/2000/svg"><path d="M18 10h28a6 6 0 0 1 6 6v6H12v-6a6 6 0 0 1 6-6Z"/><path d="M20 14h24"/><path d="M32 4v3M24 5l2 2M40 5l-2 2"/></svg>',
    shield: () => '<svg viewBox="0 0 64 32" xmlns="http://www.w3.org/2000/svg"><path d="M32 4l16 6v8c0 8-7 13-16 14-9-1-16-6-16-14v-8l16-6Z"/></svg>',
    radar: () => '<svg viewBox="0 0 64 32" xmlns="http://www.w3.org/2000/svg"><path d="M32 28a12 12 0 1 0-12-12"/><path d="M32 24a8 8 0 1 0-8-8"/><path d="M32 20a4 4 0 1 0-4-4"/><path d="M32 16l12-10"/></svg>',
    lanes: () => '<svg viewBox="0 0 64 32" xmlns="http://www.w3.org/2000/svg"><path d="M24 4v24"/><path d="M40 4v24"/><path d="M32 4v5M32 14v4M32 22v6"/></svg>',
    heat: () => '<svg viewBox="0 0 64 32" xmlns="http://www.w3.org/2000/svg"><path d="M22 26c-2-6 3-10 3-15 3 2 3 6 3 9 2-2 4-6 4-10 5 5 8 10 5 16"/><path d="M44 8c3 4 4 7 2 12"/></svg>'
  };

  const MAKE_MODELS = {
    'Acura': ['ILX','TLX','RLX','RDX','MDX'],
    'Audi': ['A3','A4','A5','A6','Q3','Q5','Q7','e-tron'],
    'BMW': ['2 Series','3 Series','4 Series','5 Series','X1','X3','X5','i4'],
    'Buick': ['Encore','Encore GX','Envision','Enclave'],
    'Cadillac': ['XT4','XT5','XT6','Escalade'],
    'Chevrolet': ['Equinox','Traverse','Tahoe','Silverado 1500','Trax','Malibu','Camaro'],
    'Chrysler': ['300','Pacifica'],
    'Dodge': ['Charger','Durango','Journey','Grand Caravan'],
    'Ford': ['F-150','Escape','Explorer','Edge','Bronco','Mustang'],
    'GMC': ['Terrain','Acadia','Yukon','Sierra 1500'],
    'Honda': ['Civic','Accord','CR-V','HR-V','Pilot','Ridgeline'],
    'Hyundai': ['Elantra','Sonata','Tucson','Santa Fe','Palisade','Kona','Ioniq 5'],
    'Infiniti': ['Q50','QX50','QX60'],
    'Jeep': ['Compass','Cherokee','Grand Cherokee','Wrangler'],
    'Kia': ['Forte','K5','Soul','Seltos','Sportage','Sorento','Telluride','Niro','EV6'],
    'Lexus': ['IS','ES','RX','NX','GX'],
    'Lincoln': ['Corsair','Nautilus','Aviator','Navigator'],
    'Mazda': ['Mazda3','Mazda6','CX-3','CX-30','CX-5','CX-50','CX-9'],
    'Mercedes-Benz': ['A-Class','C-Class','E-Class','GLA','GLC','GLE'],
    'Mini': ['Cooper','Clubman','Countryman'],
    'Mitsubishi': ['Mirage','RVR','Outlander','Outlander PHEV'],
    'Nissan': ['Sentra','Altima','Rogue','Murano','Pathfinder','Frontier'],
    'RAM': ['1500','2500'],
    'Subaru': ['Impreza','Legacy','Crosstrek','Forester','Outback','Ascent'],
    'Toyota': ['Corolla','Camry','RAV4','Highlander','Tacoma','Tundra','Prius'],
    'Volkswagen': ['Jetta','Passat','Taos','Tiguan','Atlas','Golf'],
    'Volvo': ['S60','S90','XC40','XC60','XC90']
  };

  // Lightweight (non-official) inline logo badges for the make dropdown.
  // Each is a tiny SVG monogram so the dropdown shows "make name + make logo" without external assets.
  const MAKE_LOGOS = (() => {
    const mono = (txt) => (
      '<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">' +
        '<circle class="ring" cx="12" cy="12" r="9"/>' +
        '<text x="12" y="12">' + txt + '</text>' +
      '</svg>'
    );

    return {
      'Acura': mono('A'),
      'Audi': mono('AU'),
      'BMW': mono('BM'),
      'Buick': mono('B'),
      'Cadillac': mono('C'),
      'Chevrolet': mono('CH'),
      'Chrysler': mono('CY'),
      'Dodge': mono('D'),
      'Ford': mono('F'),
      'GMC': mono('G'),
      'Honda': mono('H'),
      'Hyundai': mono('HY'),
      'Infiniti': mono('IN'),
      'Jeep': mono('J'),
      'Kia': mono('K'),
      'Lexus': mono('L'),
      'Lincoln': mono('LI'),
      'Mazda': mono('MZ'),
      'Mercedes-Benz': mono('MB'),
      'Mini': mono('MN'),
      'Mitsubishi': mono('MI'),
      'Nissan': mono('N'),
      'RAM': mono('R'),
      'Subaru': mono('SU'),
      'Toyota': mono('T'),
      'Volkswagen': mono('VW'),
      'Volvo': mono('V')
    };
  })();

  const steps = Array.from(document.querySelectorAll('.step'));
  const totalSteps = steps.length;

  const progressBar = document.getElementById('progressBar');
  const stepLabel = document.getElementById('stepLabel');
  const pctLabel = document.getElementById('pctLabel');
  const errorBox = document.getElementById('error');
  const navActions = document.getElementById('navActions');
  const prevBtn = document.getElementById('prevBtn');
  const nextBtn = document.getElementById('nextBtn');

  const dotsWrap = document.getElementById('dots');
  for (let i = 0; i < totalSteps; i++) {
    const d = document.createElement('div');
    d.className = 'dot';
    dotsWrap.appendChild(d);
  }

  let step = 0;

  const state = {
    firstName: '', lastName: '', phone: '', email: '',
    use: [], body: [],
    make: '', model: '',
    priceMin: 5000, priceMax: 100000,
    yearMin: 2010, yearMax: new Date().getFullYear(),
    mileMin: 0, mileMax: 300000,
    trans: [], drive: [],
    colors: [], interior: [],
    addons: [],
    notes: ''
  };

  function formatNum(n) { return Number(n).toLocaleString(undefined); }

  function showError(msg) {
    if (!msg) { errorBox.style.display = 'none'; errorBox.textContent = ''; return; }
    errorBox.style.display = 'block';
    errorBox.textContent = msg;
  }

  function initials(make) {
    const parts = make.split(' ').filter(Boolean);
    let out = '';
    for (const p of parts) out += p.slice(0,1);
    return out.slice(0,3).toUpperCase();
  }

  function setActiveStep(n) {
    step = Math.max(0, Math.min(totalSteps - 1, n));
    steps.forEach(s => s.classList.add('hidden'));
    steps[step].classList.remove('hidden');

    const pct = Math.round(((step + 1) / totalSteps) * 100);
    progressBar.style.width = pct + '%';
    stepLabel.textContent = 'Step ' + (step + 1) + ' of ' + totalSteps;
    pctLabel.textContent = pct + '%';

    const dotEls = Array.from(dotsWrap.children);
    dotEls.forEach((el, i) => {
      el.classList.toggle('done', i < step);
      el.classList.toggle('active', i === step);
    });

    prevBtn.style.visibility = step === 0 ? 'hidden' : 'visible';
    navActions.style.display = (step === totalSteps - 1) ? 'none' : 'flex';
    nextBtn.textContent = (step === 8) ? 'Submit' : (step === 9) ? 'Continue' : 'Next';

    showError('');
    updateNextState();
  }

  function validateStep(s) {
    if (s === 0) {
      const hasName = !!(state.firstName.trim() && state.lastName.trim());

      const phoneDigits = (state.phone || '').replace(/[^0-9]/g, '');
      const hasPhone = phoneDigits.length > 0;
      const phoneOk = !hasPhone || phoneDigits.length === 10;

      const emailVal = (state.email || '').trim();
      const hasEmail = emailVal.length > 0;
      // basic email check (keeps UI simple and avoids being overly strict)
      const emailOk = !hasEmail || /^[^@ ]+@[^@ ]+\.[^@ ]+$/.test(emailVal);

      const hasContact = hasPhone || hasEmail;
      return hasName && hasContact && phoneOk && emailOk;
    }
    if (s === 1) return state.use.length > 0;
    if (s === 2) return state.body.length > 0;
    if (s === 3) return !!(state.make && state.model);
    if (s === 5) return state.trans.length > 0 && state.drive.length > 0;
    if (s === 6) return state.colors.length > 0 && state.interior.length > 0;
    // STEP 8 (additional options) is optional
    if (s === 7) return true;
    return true;
  }

  function stepErrorMessage(s) {
    if (s === 0) {
      if (!(state.firstName.trim() && state.lastName.trim())) return 'Please enter your first and last name';

      const phoneDigits = (state.phone || '').replace(/[^0-9]/g, '');
      const hasPhone = phoneDigits.length > 0;
      const hasEmail = (state.email || '').trim().length > 0;

      if (!hasPhone && !hasEmail) return 'Please enter phone or email';
      if (hasPhone && phoneDigits.length !== 10) return 'Phone number must be 10 digits';

      const emailVal = (state.email || '').trim();
      if (emailVal && !/^[^@ ]+@[^@ ]+\.[^@ ]+$/.test(emailVal)) return 'Please enter a valid email';

      return 'Please check your contact details';
    }

    // keep existing wording for multi-select steps
    if (s === 1 || s === 2 || s === 5 || s === 6) return 'Please, choose at least one';

    if (s === 3) return 'Please choose a make and model';

    return 'Please check this step';
  }

  function updateNextState() {
    const ok = validateStep(step);
    nextBtn.disabled = !ok;
    nextBtn.classList.toggle('ready', ok);
  }

  function toggleInArray(arr, v) {
    const i = arr.indexOf(v);
    if (i >= 0) arr.splice(i, 1);
    else arr.push(v);
  }

  function buildTiles(containerId, groupKey, items) {
    const el = document.getElementById(containerId);
    el.innerHTML = '';
    items.forEach(item => {
      const t = document.createElement('div');
      t.className = 'tile';
      t.dataset.group = groupKey;
      t.dataset.value = item.value;

      const iconHtml = item.type === 'swatch'
        ? '<div class="swatch" style="background:' + item.swatch + '"></div>'
        : item.icon();

      t.innerHTML = iconHtml + '<div class="label">' + item.label + '</div>';

      t.addEventListener('click', () => {
        toggleInArray(state[groupKey], item.value);
        t.classList.toggle('active');
        updateNextState();
      });

      el.appendChild(t);
    });
  }

  buildTiles('useGrid', 'use', [
    { value: 'Family', label: 'Family', icon: svg.family },
    { value: 'Commute', label: 'Commute', icon: svg.commute },
    { value: 'Fun', label: 'Fun', icon: svg.fun },
    { value: 'Work', label: 'Work', icon: svg.work }
  ]);

  buildTiles('bodyGrid', 'body', [
    { value: 'Hatchback', label: 'Hatchback', icon: svg.hatchback },
    { value: 'Minivan', label: 'Minivan', icon: svg.minivan },
    { value: 'Pickup', label: 'Pickup', icon: svg.pickup },
    { value: 'Crew Cab', label: 'Crew Cab', icon: svg.crewcab },
    { value: 'SUV', label: 'SUV', icon: svg.suv },
    { value: 'Sedan', label: 'Sedan', icon: svg.sedan }
  ]);

  buildTiles('transGrid', 'trans', [
    { value: 'Auto', label: 'Auto', icon: svg.gear },
    { value: 'Manual', label: 'Manual', icon: svg.gear },
    { value: 'CVT', label: 'CVT', icon: svg.gear },
    { value: 'Other', label: 'Other', icon: svg.gear }
  ]);

  buildTiles('driveGrid', 'drive', [
    { value: '4x4', label: '4x4', icon: svg.wheel },
    { value: 'AWD', label: 'AWD', icon: svg.wheel },
    { value: 'FWD', label: 'FWD', icon: svg.wheel },
    { value: 'RWD', label: 'RWD', icon: svg.wheel }
  ]);

  buildTiles('colorGrid', 'colors', [
    { value: 'White', label: 'White', type: 'swatch', swatch: '#ffffff' },
    { value: 'Black', label: 'Black', type: 'swatch', swatch: '#0b0b0b' },
    { value: 'Blue', label: 'Blue', type: 'swatch', swatch: '#2563eb' },
    { value: 'Green', label: 'Green', type: 'swatch', swatch: '#16a34a' },
    { value: 'Red', label: 'Red', type: 'swatch', swatch: '#dc2626' },
    { value: 'Grey', label: 'Grey', type: 'swatch', swatch: '#a1a1aa' },
    { value: 'Yellow', label: 'Yellow', type: 'swatch', swatch: '#facc15' },
    { value: 'Other', label: 'Other', type: 'swatch', swatch: '#64748b' }
  ]);

  buildTiles('interiorGrid', 'interior', [
    { value: 'Leather', label: 'Leather', icon: svg.leather },
    { value: 'Cloth', label: 'Cloth', icon: svg.cloth }
  ]);

  buildTiles('addonGrid', 'addons', [
    { value: 'Blind spot', label: 'Blind spot', icon: svg.radar },
    { value: 'Heated seats', label: 'Heated seats', icon: svg.heat },
    { value: 'Remote start', label: 'Remote start', icon: svg.shield },
    { value: 'Lane assist', label: 'Lane assist', icon: svg.lanes },
    { value: 'Sunroof', label: 'Sunroof', icon: svg.sunroof },
    { value: 'Steering wheel heater', label: 'Steering wheel heater', icon: svg.wheel }
  ]);

  // STEP 8 is optional → no requirement to select addons


  document.querySelectorAll('.clearLink').forEach(link => {
    link.addEventListener('click', () => {
      const key = link.dataset.clear;
      if (!key) return;
      state[key] = [];
      document.querySelectorAll('.tile').forEach(t => {
        if (t.dataset.group === key) t.classList.remove('active');
      });
      updateNextState();
    });
  });

  const firstName = document.getElementById('firstName');
  const lastName = document.getElementById('lastName');
  const phone = document.getElementById('phone');
  const email = document.getElementById('email');

  function syncContact() {
    state.firstName = firstName.value;
    state.lastName = lastName.value;
    state.phone = phone.value;
    state.email = email.value;
    updateNextState();
  }

  [firstName, lastName, phone, email].forEach(el => el.addEventListener('input', syncContact));

  const makeButton = document.getElementById('makeButton');
  const makeMenu = document.getElementById('makeMenu');
  const makeList = document.getElementById('makeList');
  const makeSearch = document.getElementById('makeSearch');
  const makeText = document.getElementById('makeText');
  const makeLogo = document.getElementById('makeLogo');
  const modelSelect = document.getElementById('model');

  const ALL_MAKES = Object.keys(MAKE_MODELS).sort((a,b) => a.localeCompare(b));

  function closeMakeMenu() {
    makeMenu.classList.remove('open');
    makeButton.setAttribute('aria-expanded', 'false');
  }

  function renderMakeList(filter) {
    makeList.innerHTML = '';
    const q = (filter || '').trim().toLowerCase();

    ALL_MAKES.forEach(m => {
      if (q && m.toLowerCase().indexOf(q) === -1) return;
      const item = document.createElement('div');
      item.className = 'makeItem';
      item.innerHTML = '<div class="logo">' + (MAKE_LOGOS[m] || initials(m)) + '</div><div class="name">' + m + '</div>';
      item.addEventListener('click', () => {
        state.make = m;
        state.model = '';
        makeText.textContent = m;
        makeLogo.innerHTML = (MAKE_LOGOS[m] || initials(m));
        populateModels(m);
        modelSelect.value = '';
        closeMakeMenu();
        updateNextState();
      });
      makeList.appendChild(item);
    });
  }

  function openMakeMenu() {
    makeMenu.classList.add('open');
    makeButton.setAttribute('aria-expanded', 'true');
    makeSearch.value = '';
    renderMakeList('');
    setTimeout(() => makeSearch.focus(), 0);
  }

  function populateModels(make) {
    const models = MAKE_MODELS[make] || [];
    modelSelect.innerHTML = '';
    const placeholder = document.createElement('option');
    placeholder.value = '';
    placeholder.textContent = 'Choose a model';
    modelSelect.appendChild(placeholder);
    models.forEach(model => {
      const opt = document.createElement('option');
      opt.value = model;
      opt.textContent = model;
      modelSelect.appendChild(opt);
    });
    modelSelect.disabled = false;
  }

  makeButton.addEventListener('click', () => {
    const isOpen = makeMenu.classList.contains('open');
    if (isOpen) closeMakeMenu(); else openMakeMenu();
  });

  makeSearch.addEventListener('input', () => renderMakeList(makeSearch.value));

  document.addEventListener('click', (e) => {
    const root = document.getElementById('makeSelect');
    if (!root.contains(e.target)) closeMakeMenu();
  });

  modelSelect.addEventListener('change', () => {
    state.model = modelSelect.value;
    updateNextState();
  });

  renderMakeList('');

  const yearNow = new Date().getFullYear();

  const priceMin = document.getElementById('priceMin');
  const priceMax = document.getElementById('priceMax');
  const priceFill = document.getElementById('priceFill');
  const priceLabel = document.getElementById('priceRangeLabel');

  const yearMin = document.getElementById('yearMin');
  const yearMax = document.getElementById('yearMax');
  const yearFill = document.getElementById('yearFill');
  const yearLabel = document.getElementById('yearRangeLabel');

  const mileMin = document.getElementById('mileMin');
  const mileMax = document.getElementById('mileMax');
  const mileFill = document.getElementById('mileFill');
  const mileLabel = document.getElementById('mileRangeLabel');

  yearMin.max = String(yearNow);
  yearMax.max = String(yearNow);
  yearMax.value = String(yearNow);
  state.yearMax = yearNow;
  yearLabel.textContent = '2010 – ' + yearNow;

  function clampPair(minEl, maxEl) {
    let a = Number(minEl.value);
    let b = Number(maxEl.value);
    if (a > b) {
      const t = a; a = b; b = t;
      minEl.value = String(a);
      maxEl.value = String(b);
    }
    return [a, b];
  }

  function updateFill(minEl, maxEl, fillEl) {
    const min = Number(minEl.min);
    const max = Number(minEl.max);
    const pair = clampPair(minEl, maxEl);
    const a = pair[0];
    const b = pair[1];
    const leftPct = ((a - min) / (max - min)) * 100;
    const rightPct = ((b - min) / (max - min)) * 100;
    fillEl.style.left = leftPct + '%';
    fillEl.style.right = (100 - rightPct) + '%';
    return [a, b];
  }

  function syncAllRanges() {
    const p = updateFill(priceMin, priceMax, priceFill);
    state.priceMin = p[0]; state.priceMax = p[1];
    priceLabel.textContent = '$' + formatNum(p[0]) + ' – $' + formatNum(p[1]);

    const y = updateFill(yearMin, yearMax, yearFill);
    state.yearMin = y[0]; state.yearMax = y[1];
    yearLabel.textContent = y[0] + ' – ' + y[1];

    const m = updateFill(mileMin, mileMax, mileFill);
    state.mileMin = m[0]; state.mileMax = m[1];
    mileLabel.textContent = formatNum(m[0]) + ' – ' + formatNum(m[1]);
  }

  [priceMin, priceMax, yearMin, yearMax, mileMin, mileMax].forEach(el => {
    el.addEventListener('input', () => { syncAllRanges(); updateNextState(); });
  });

  syncAllRanges();

  const notes = document.getElementById('notes');
  notes.addEventListener('input', () => { state.notes = notes.value; });

  function join(arr) { return (arr && arr.length) ? arr.join(', ') : '—'; }

  function buildSummary() {
    const box = document.getElementById('summaryBox');
    const rows = [
      ['Name', (state.firstName + ' ' + state.lastName).trim() || '—'],
      ['Phone', state.phone || '—'],
      ['Email', state.email || '—'],
      ['Use', join(state.use)],
      ['Bodystyles', join(state.body)],
      ['Make/Model', state.make ? (state.make + ' ' + (state.model || '')).trim() : '—'],
      ['Price', '$' + formatNum(state.priceMin) + ' – $' + formatNum(state.priceMax)],
      ['Years', state.yearMin + ' – ' + state.yearMax],
      ['Mileage', formatNum(state.mileMin) + ' – ' + formatNum(state.mileMax) + ' km'],
      ['Transmission', join(state.trans)],
      ['Drivetrain', join(state.drive)],
      ['Exterior', join(state.colors)],
      ['Interior', join(state.interior)],
      ['Options', join(state.addons)],
      ['Notes', state.notes && state.notes.trim() ? state.notes.trim() : '—']
    ];

    let html = '<div class="summaryGrid">';
    rows.forEach(r => {
      html += '<div class="summaryRow"><div class="summaryKey">' + r[0] + '</div><div class="summaryVal">' + r[1] + '</div></div>';
    });
    html += '</div>';
    box.innerHTML = html;
  }

  nextBtn.addEventListener('click', () => {
    if (!validateStep(step)) { showError(stepErrorMessage(step)); return; }

    if (step === 8) { buildSummary(); setActiveStep(9); return; }
    if (step === 9) { setActiveStep(10); return; }

    setActiveStep(step + 1);
  });

  prevBtn.addEventListener('click', () => setActiveStep(step - 1));

  document.getElementById('restartBtn').addEventListener('click', () => {
    state.firstName = ''; state.lastName = ''; state.phone = ''; state.email = '';
    state.use = []; state.body = []; state.make = ''; state.model = '';
    state.priceMin = 5000; state.priceMax = 100000;
    state.yearMin = 2010; state.yearMax = yearNow;
    state.mileMin = 0; state.mileMax = 300000;
    state.trans = []; state.drive = []; state.colors = []; state.interior = []; state.addons = [];
    state.notes = '';

    firstName.value = ''; lastName.value = ''; phone.value = ''; email.value = ''; notes.value = '';
    document.querySelectorAll('.tile').forEach(t => t.classList.remove('active'));

    makeText.textContent = 'Choose a make';
    makeLogo.innerHTML = '—';
    modelSelect.disabled = true;
    modelSelect.innerHTML = '<option value="">Select make first</option>';

    priceMin.value = '5000'; priceMax.value = '100000';
    yearMin.value = '2010'; yearMax.value = String(yearNow);
    mileMin.value = '0'; mileMax.value = '300000';
    syncAllRanges();

    setActiveStep(0);
  });

  setActiveStep(0);
</script>
</body>
</html>
